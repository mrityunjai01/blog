
<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Introduction
  #

Tokenization of text from scratch typically involves three steps: Pretokenization, Training a tokenizer, Writing an encoder-decoder pair which uses the learned vocab and merges files generated by the tokenizer. Typically, the most time and memory consuming step is the training of the tokenizer. In this post, I will show five levels of optimization in the training of a BPE tokenizer in 5 levels, starting from a simple Python code and ending with an performant rust implementation.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="/docs/bpe_tokenizer_training/">
  <meta property="og:site_name" content="Collection of Short Articles on ML">
  <meta property="og:title" content="5 Levels of Optimizing Tokenizer Training with Simple Python Code">
  <meta property="og:description" content="Introduction # Tokenization of text from scratch typically involves three steps: Pretokenization, Training a tokenizer, Writing an encoder-decoder pair which uses the learned vocab and merges files generated by the tokenizer. Typically, the most time and memory consuming step is the training of the tokenizer. In this post, I will show five levels of optimization in the training of a BPE tokenizer in 5 levels, starting from a simple Python code and ending with an performant rust implementation.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2025-04-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-01T00:00:00+00:00">
    <meta property="article:tag" content="Static Site Generator">
    <meta property="article:tag" content="Tutorial">
    <meta property="article:tag" content="Documentation">
<title>5 Levels of Optimizing Tokenizer Training with Simple Python Code | Collection of Short Articles on ML</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="/docs/bpe_tokenizer_training/">
<link rel="stylesheet" href="/book.min.27c601ff251cc5c9796bb272aace960013cf351d0c28a7e1301487b32d4800ee.css" >
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.62a0798c10ab97f02b36c6ddbc4fc08bde051286945ebc3d8b3506a376b65da7.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
    
  
    <script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>
<script>
  MathJax = {
    tex: {
      displayMath: [
        ["\\[", "\\]"],
        ["$$", "$$"],
      ], 
      inlineMath: [["\\(", "\\)"]], 
    },
    loader: {
      load: ["ui/safe"],
    },
  };
</script>

  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Collection of Short Articles on ML</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/ret_1/" class="">Zero-shot Retrieval With Priors</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/bpe_tokenizer_training/" class="active">5 Levels of Optimizing Tokenizer Training with Simple Python Code</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/param_dt/" class="">Continuously Parametrizing Decision Trees</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/search/" class="">Parametrizing Decision Trees</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/reddit_astroturfing/" class="">Reddit Astroturfing: A Bayesian Approach</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/omitted_vars/" class="">Can Machines Search for Omitted Variables?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/technical_trading/" class="">Snooping in Technical Trading</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/mle_nn/" class="">Maximum Likelihood Estimation for Neural Networks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/span/" class="">SPAN</a>
  

        </li>
      
    
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>5 Levels of Optimizing Tokenizer Training with Simple Python Code</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#merge-updates">Merge updates</a></li>
    <li><a href="#sorting-in-intervals">Sorting in intervals</a></li>
    <li><a href="#processing-subsets">Processing Subsets</a></li>
    <li><a href="#parallelization">Parallelization</a></li>
    <li><a href="#porting-to-rust">Porting to Rust</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="introduction">
  Introduction
  <a class="anchor" href="#introduction">#</a>
</h1>
<p>Tokenization of text from scratch typically involves three steps: Pretokenization, Training a tokenizer, Writing an encoder-decoder pair which uses the learned vocab and merges files generated by the tokenizer. Typically, the most time and memory consuming step is the training of the tokenizer. In this post, I will show five levels of optimization in the training of a BPE tokenizer in 5 levels, starting from a simple Python code and ending with an performant rust implementation.</p>
<h1 id="context">
  Context
  <a class="anchor" href="#context">#</a>
</h1>
<h1 id="optimizations">
  Optimizations
  <a class="anchor" href="#optimizations">#</a>
</h1>
<h2 id="merge-updates">
  Merge updates
  <a class="anchor" href="#merge-updates">#</a>
</h2>
<h2 id="sorting-in-intervals">
  Sorting in intervals
  <a class="anchor" href="#sorting-in-intervals">#</a>
</h2>
<h2 id="processing-subsets">
  Processing Subsets
  <a class="anchor" href="#processing-subsets">#</a>
</h2>
<h2 id="parallelization">
  Parallelization
  <a class="anchor" href="#parallelization">#</a>
</h2>
<h2 id="porting-to-rust">
  Porting to Rust
  <a class="anchor" href="#porting-to-rust">#</a>
</h2>
<h1 id="conclusion">
  Conclusion
  <a class="anchor" href="#conclusion">#</a>
</h1>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#merge-updates">Merge updates</a></li>
    <li><a href="#sorting-in-intervals">Sorting in intervals</a></li>
    <li><a href="#processing-subsets">Processing Subsets</a></li>
    <li><a href="#parallelization">Parallelization</a></li>
    <li><a href="#porting-to-rust">Porting to Rust</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: "dark" });
  </script>
</body>
</html>












